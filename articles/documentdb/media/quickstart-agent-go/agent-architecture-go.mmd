%% STEPS TO GENERATE IMAGE
%% =======================
%% 1. Install mermaid CLI v10.9.1 (see https://github.com/mermaid-js/mermaid-cli/blob/master/README.md):
%%    npm i -g @mermaid-js/mermaid-cli@10.9.1
%% 2. Run command: mmdc -i agent-architecture-go.mmd -o ./agent-architecture-go.svg

flowchart TB
    subgraph Planner["Planner agent (gpt-4o-mini)"]
        P1[Refine user query]
        P2[OpenAI function calling]
        P3[Return structured data<br/>with similarity scores]
    end

    subgraph Tool["Vector search tool"]
        T1[Generate embeddings<br/>text-embedding-3-small]
        T2[Execute MongoDB vector search<br/>cosine similarity]
        T3[Format results]
    end

    subgraph Synthesizer["Synthesizer agent (gpt-4o)"]
        S1[Analyze top 3 results<br/>comparatively]
        S2[Generate natural language<br/>recommendations]
        S3[Explain tradeoffs<br/>between options]
    end

    P1 --> P2 --> T1 --> T2 --> T3 --> P3 --> Synthesizer
    S1 --> S2 --> S3

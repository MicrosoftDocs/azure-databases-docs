---
ms.service: azure-cosmos-db
ms.topic: include
ms.date: 11/24/2025
---

### Overview

The Azure Cosmos DB .NET SDK has a dependency on `Newtonsoft.Json` for JSON serialization operations. **This dependency is not managed automatically** - you must explicitly add `Newtonsoft.Json` as a direct dependency in your project.

The SDK compiles against Newtonsoft.Json 10.x internally, which has a known security vulnerability. While the SDK is technically compatible with 10.x, and the SDK's usage of Newtonsoft.Json is not susceptible to the reported security issue, we still **recommend using version 13.0.3 or higher** to avoid potential security issues or conflicts. The 13.x versions include breaking changes, but the SDK's usage patterns are compatible with these changes.

> [!IMPORTANT]
> This dependency is required even when using `System.Text.Json` for user-defined types via [CosmosClientOptions.UseSystemTextJsonSerializerWithOptions](/dotnet/api/microsoft.azure.cosmos.cosmosclientoptions.usesystemtextjsonserializerwithoptions?view=azure-dotnet&preserve-view=true), because the SDK's internal operations still use Newtonsoft.Json for system types.

### Recommended Configuration

**Always explicitly add `Newtonsoft.Json` version 13.0.3 or higher as a direct dependency** when using the Azure Cosmos DB .NET SDK v3. Do not use version 10.x due to known security vulnerabilities.

#### For Standard .csproj Projects

```xml
<ItemGroup>
  <PackageReference Include="Microsoft.Azure.Cosmos" Version="3.47.0" />
  <PackageReference Include="Newtonsoft.Json" Version="13.0.4" />
</ItemGroup>
```

#### For Projects Using Central Package Management

If your project uses `Directory.Packages.props`:

```xml
<Project>
  <ItemGroup>
    <PackageVersion Include="Microsoft.Azure.Cosmos" Version="3.47.0" />
    <PackageVersion Include="Newtonsoft.Json" Version="13.0.4" />
  </ItemGroup>
</Project>
```

### Troubleshooting Version Conflicts

#### Missing Newtonsoft.Json Reference

If you encounter a build error like:

```
The Newtonsoft.Json package must be explicitly referenced with version >= 10.0.2. Please add a reference to Newtonsoft.Json or set the 'AzureCosmosDisableNewtonsoftJsonCheck' property to 'true' to bypass this check.
```

This error is intentionally generated by the Cosmos DB SDK's build targets to ensure the dependency is properly configured.

**Solution for Applications:**

Add an explicit reference to Newtonsoft.Json as shown in the [Recommended Configuration](#recommended-configuration) section above.

**Solution for Libraries:**

If you're building a library (not an application) and want to defer the Newtonsoft.Json dependency to your library's consumers, you can bypass this check by setting the MSBuild property in your `.csproj`:

```xml
<PropertyGroup>
  <AzureCosmosDisableNewtonsoftJsonCheck>true</AzureCosmosDisableNewtonsoftJsonCheck>
</PropertyGroup>
```

> [!WARNING]
> Only use this bypass when building libraries where end users will provide the Newtonsoft.Json dependency. For applications, always add the explicit reference.

#### Package Version Conflicts

If you encounter build errors like:

```
error NU1109: Detected package downgrade: Newtonsoft.Json from 13.0.4 to centrally defined 13.0.3
```

**Solution:**

1. **Identify the required version** by checking which packages need newer versions:
   ```powershell
   dotnet list package --include-transitive | Select-String "Newtonsoft.Json"
   ```

2. **Update your centralized package version** to match or exceed the highest required version:
   ```xml
   <PackageVersion Include="Newtonsoft.Json" Version="13.0.4" />
   ```

3. **Clean and rebuild**:
   ```powershell
   dotnet clean
   dotnet restore
   dotnet build
   ```

### Version Compatibility

The following table shows the **minimum recommended secure versions** of Newtonsoft.Json for each Cosmos DB SDK version. While the SDK can technically work with 10.x, these versions should never be used due to security vulnerabilities.

| Cosmos DB SDK Version | Minimum Secure Version | Recommended |
|----------------------|------------------------|-------------|
| 3.47.0+              | 13.0.3                 | 13.0.4      |
| 3.54.0+              | 13.0.4                 | 13.0.4      |

> [!TIP]
> When using .NET Aspire 13.0.0 or later, ensure `Newtonsoft.Json` is at version 13.0.4 to avoid conflicts with Aspire's Azure components.

### Best Practices

1. **Always add as a direct dependency** - The SDK does not automatically manage this dependency for you
2. **Use version 13.0.3 or higher** - Never use 10.x despite technical compatibility, due to known security vulnerabilities
3. **Required even with System.Text.Json** - You must include Newtonsoft.Json even when using `UseSystemTextJsonSerializerWithOptions`, as the SDK uses it internally for system types
4. **Pin the version explicitly** - Don't rely on transitive dependency resolution
5. **Monitor warnings** - Treat NuGet package downgrade warnings (NU1109) as errors in CI/CD pipelines

---
---
title: |
  Tutorial: Monitoring and Collecting Driver Logs in Azure Cosmos DB for MongoDB vCore
titleSuffix: Azure Cosmos DB for MongoDB (vCore)
description: This tutorial provides a detailed guide to monitoring MongoDB driver logs for Azure Cosmos DB for MongoDB vCore. It covers the integration of Azure Application Insights for real-time telemetry and log analysis, along with steps to configure Splunk as a centralized log management tool. Learn how to enable and analyze MongoDB driver logs, set up alerts, and visualize critical metrics like query performance, retries, and connection issues. The guide also emphasizes best practices for ensuring secure and efficient log management to maintain database performance and reliability.

author: v-smedapati
ms.author: v-smedapati
ms.service: azure-cosmos-db
ms.subservice: mongodb-vcore
ms.topic: tutorial
ms.date: 11/29/2024
# CustomerIntent: As a developer or database administrator, I need to monitor and analyze MongoDB driver logs in Azure Cosmos DB for MongoDB vCore to troubleshoot issues, optimize query performance, and ensure secure and efficient database operations using tools like Application Insights and Splunk.
---

# Monitoring and Collecting Driver Logs in Azure Cosmos DB for MongoDB vCore

[!INCLUDE[MongoDB (vCore)](~/reusable-content/ce-skilling/azure/includes/cosmos-db/includes/appliesto-mongodb-vcore.md)]

Monitoring is essential for ensuring the performance, reliability, and health of database systems. This document explains how to collect and analyze MongoDB driver logs for Azure Cosmos DB for MongoDB vCore using **Azure Application Insights** and **Splunk**. These tools help diagnose performance issues, identify anomalies, and improve system efficiency.

## Key Concepts

1. **Driver Logs:** Logs generated by the MongoDB driver, detailing connection events, operations, retries, and potential issues.
1. **Application Insights:** A built-in Azure monitoring tool for collecting logs, metrics, and traces from applications.
1. **Splunk:** A third-party analytics platform for monitoring, searching, and visualizing large volumes of log data.

## Monitoring with Application Insights

Application Insights is a comprehensive tool that integrates seamlessly with Azure services. It provides real-time monitoring, query analysis, and rich telemetry capabilities.

## Setting Up Application Insights
1. **Create an Application Insights Resource**

    - Log in to the Azure Portal.
Navigate to Create a Resource > Application Insights.
Select the desired subscription and resource group, and name the resource.
Configure Application Insights for Your Application

Install the Application Insights SDK for your programming language.
For Node.js:
bash
Copy
Edit
npm install applicationinsights
Enable Application Insights in your code:
javascript
Copy
Edit
const appInsights = require('applicationinsights');
appInsights.setup('<Instrumentation-Key>').start();
Enable MongoDB Driver Logs

Configure the MongoDB driver to enable verbose logging:
javascript
Copy
Edit
const { MongoClient } = require('mongodb');
const client = new MongoClient('<connection-string>', { monitorCommands: true });

client.on('commandStarted', event => console.log('Command Started:', event));
client.on('commandSucceeded', event => console.log('Command Succeeded:', event));
client.on('commandFailed', event => console.log('Command Failed:', event));
Logs can be forwarded to Application Insights using the SDK.
Analyze Logs in Application Insights

Use Log Analytics to query and analyze the logs:
kusto
Copy
Edit
traces
| where message contains "Command Started"
| summarize count() by tostring(customDimensions.driverOperation)
